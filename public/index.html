<!DOCTYPE html>
<!-- saved from url=(0039)https://homicide-dashboard.netlify.app/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tracking Jackson's Homicides</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="">
    
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js"></script>

    <style>
        /* --- BASE STYLES & COLOR THEME --- */
        :root {
            --body-bg: #e9ecef;
            --content-bg: #ffffff;
            --text-color: #212529;
            --header-bg: #ffffff;
            --header-border: #dee2e6;
            --banner-bg: #d9534f; 
            --banner-text: #ffffff;
            --legend-bg: #f8f9fa;
            --legend-border: #dee2e6;
            --legend-label-text: #495057;
            --input-border: #ced4da;
            --input-bg: #ffffff;
            --chart-title-text: #343a40;
            --chart-axis-text: #6c757d;
            --chart-grid-color: rgba(0, 0, 0, 0.1);
            --chart-legend-text: #333;
            --footer-bg: #f8f9fa;
            --footer-text: #6c757d;
            --footer-link: #0056b3;
            --tooltip-bg: rgba(33, 37, 41, 0.9);
            --tooltip-text: #f8f9fa;
            --map-placeholder-bg: #adb5bd;
            --boundary-city-color: #000000; 
            --boundary-ccid-color: #E65100; 
            --rank-banner-rank1-bg: #d9534f; 
            --rank-banner-rank2to5-bg: #f0ad4e; 
            --rank-banner-ranklow-bg: #5cb85c; 
            --rank-banner-error-bg: #777777; 
            --percentage-increase-color: #d9534f; 
            --percentage-decrease-color: #5cb85c; 
            --percentage-neutral-color: var(--text-color); 
        }
        
        body, html {
            height: 100%; margin: 0; padding: 0;
            font-family: 'Helvetica Neue', Arial, sans-serif;
            display: flex; flex-direction: column;
            background-color: var(--body-bg);
            color: var(--text-color);
            -webkit-text-size-adjust: 100%; 
            text-size-adjust: 100%;
        }

        /* --- LAYOUT & COMPONENT STYLES --- */
        .header {
            display: flex; justify-content: center; align-items: center;
            padding: 10px 15px; 
            background-color: var(--header-bg);
            border-bottom: 2px solid var(--header-border);
            flex-shrink: 0;
            position: relative; 
        }
        .header-logo-main { }
        .header-logo-secondary {
            position: absolute;
            right: 20px; 
            top: 50%;
            transform: translateY(-50%);
        }
        .header-logo-main img, .header-logo-secondary img { 
            max-height: 45px; 
            width: auto; 
            object-fit: contain; 
            vertical-align: middle; 
        } 
        
        .count-banner, .ranking-banner { 
            color: var(--banner-text);
            text-align: center; padding: 8px 15px; 
            font-size: 1.8em; 
            font-weight: bold;
            flex-shrink: 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1); 
        }
        .count-banner { background-color: var(--banner-bg); }
        .ranking-banner { 
            font-size: 1.3em; 
            padding: 6px 15px;
            background-color: var(--rank-banner-error-bg); 
        }

        .main-content-area { 
            display: flex; 
            flex: 1 1 auto; 
            min-height: 300px; 
            background-color: var(--content-bg); 
        }
        
        .legend-container {
            width: 30%; 
            max-width: 400px; 
            padding: 15px; 
            border-right: 1px solid var(--legend-border);
            overflow-y: auto; background-color: var(--legend-bg); 
            display: flex; 
            flex-direction: column; 
            flex-shrink: 0; 
        }
        
        .filter-columns-wrapper { 
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between; 
            flex-grow: 1; 
            margin-bottom: 10px; 
        }

        .filter-group { 
            margin-bottom: 10px; 
            box-sizing: border-box;
        } 
        
        .filter-group.year-filter, .filter-group.agency-filter {
            width: 48%; 
        }
        .filter-group.circumstance-filter, .filter-group.percentage-change-display { 
            width: 100%;
            margin-top: 10px; 
        }
        .filter-group.percentage-change-display {
            margin-top: 15px; 
        }

        .filter-group label.group-label { 
            display: block; margin-bottom: 5px; 
            font-weight: bold;
            font-size: 0.95em; 
            color: var(--legend-label-text); 
        }
        .filter-group select, .filter-group .checkbox-group {
            width: 100%; padding: 6px; 
            border: 1px solid var(--input-border);
            border-radius: 4px; font-size: 0.9em; 
            box-sizing: border-box; background-color: var(--input-bg); color: var(--text-color);
        }
        .checkbox-group { 
            max-height: 150px; 
            overflow-y: auto; 
            background-color: var(--input-bg); 
            padding: 8px; 
        }
        .checkbox-group div { margin-bottom: 3px; display: flex; align-items: center;}
        .checkbox-group input[type="checkbox"] { margin-right: 5px; }
        .checkbox-group label { font-weight: normal; font-size: 0.85em; color: var(--legend-label-text);}
        
        #percentageChangeText { 
            text-align: center; 
            font-weight: bold; 
            padding: 10px; 
            background-color: var(--input-bg); 
            border: 1px solid var(--input-border); 
            border-radius: 4px;
            font-size: 1.8em; 
        }

        .map-container { flex-grow: 1; min-height: 300px;  }
        #map { height: 100%; width: 100%; background-color: var(--map-placeholder-bg); } 
        
        .charts-area { 
            display: flex; 
            flex-wrap: wrap; 
            flex: 0 1 auto; 
            background-color: var(--content-bg); 
            border-top: 1px solid var(--legend-border); 
        }
        .chart-box { 
            width: 50%; 
            padding: 20px; 
            position: relative; 
            display: flex; 
            flex-direction: column; 
            box-sizing: border-box; 
        }
        .chart-box:nth-child(odd) { 
            border-right: 1px solid var(--legend-border); 
        }
        .chart-box:nth-child(1), .chart-box:nth-child(2) {
            border-bottom: 1px solid var(--legend-border);
        }

        .chart-box h4 { text-align: center; margin-top: 0; margin-bottom: 15px; font-size: 1.1em; color: var(--chart-title-text); }
        .chart-canvas-container { flex-grow: 1; position: relative; min-height: 250px; } 

        .footer {
            padding: 10px 15px; text-align: center; 
            font-size: 0.8em; color: var(--footer-text); 
            background-color: var(--footer-bg);
            border-top: 1px solid var(--header-border); flex-shrink: 0;
        }
        .footer p { margin: 5px 0; } 
        .footer a { color: var(--footer-link); text-decoration: none; } 
        .footer a:hover { text-decoration: underline; }

        /* --- PLUGIN & MODAL STYLES --- */
        .leaflet-tooltip {
            background-color: var(--tooltip-bg); 
            color: var(--tooltip-text);
            border: none; box-shadow: 0 2px 5px rgba(0,0,0,0.2); 
            border-radius: 4px; padding: 10px 15px; 
            font-size: 1em; 
        }
        .leaflet-tooltip p { margin: 5px 0; } 
        .leaflet-tooltip b { color: var(--tooltip-text); font-weight: bold; } 

        .leaflet-control-layers { background: var(--content-bg); border: 1px solid var(--legend-border); }
        .leaflet-control-layers-selector, .leaflet-control-layers label, .leaflet-control-layers label span { color: var(--text-color); }

        .modal-overlay {
            display: none; position: fixed;
            z-index: 1000; left: 0; top: 0;
            width: 100%; height: 100%;
            overflow: auto; background-color: rgba(0,0,0,0.5); 
            justify-content: center; align-items: center;
        }
        .modal-content {
            background-color: #fefefe; padding: 20px;
            border: 1px solid #888; border-radius: 8px;
            width: 90%; max-width: 600px; position: relative;
            box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);
        }
        .modal-close {
            color: #aaa; position: absolute; top: 10px; right: 20px;
            font-size: 28px; font-weight: bold; line-height: 1;
            cursor: pointer;
        }
        .modal-close:hover, .modal-close:focus { color: black; text-decoration: none; }
        .modal-content h2 { margin-top: 0; color: #333; }
        .modal-content p { line-height: 1.6; color: #555; }
        
        /* --- RESPONSIVE STYLES --- */

        /* Medium screens (tablets) */
        @media (max-width: 992px) { 
            .main-content-area { flex-direction: column; flex: 1 1 auto; }
            .legend-container { width: 100%; max-width: none; border-right: none; border-bottom: 2px solid var(--legend-border); max-height: 45vh; flex-shrink:0;} 
            .map-container { 
                /* MOBILE-IMPROVEMENT: Use viewport height for better adaptability */
                height: 50vh; 
                flex-grow: 1; 
                flex-shrink: 0; 
            } 
            .chart-box { width: 50%; }
            .chart-box:nth-child(even) { border-right: none; }
        }
        
        /* Small screens (large phones, small tablets) */
        @media (max-width: 768px) {
            .header { 
                flex-direction: row; 
                justify-content: space-around; 
                padding: 8px 10px;
            }
            .header-logo-main img, .header-logo-secondary img { max-height: 35px; } 

            .count-banner { font-size: 1.3em; padding: 6px 10px;} 
            .ranking-banner { font-size: 1.0em; padding: 5px 10px;}
            
            .charts-area { flex-direction: column; } 
            .chart-box { width: 100%; padding: 15px; }
            .chart-box:first-child, .chart-box:nth-child(2), .chart-box:nth-child(3) { 
                border-right: none; 
                border-bottom: 1px solid var(--legend-border); 
            }
            
            .legend-container { padding: 10px; max-height: 40vh; } 
            .filter-columns-wrapper { flex-direction: column; flex-grow: 0; }
            .filter-group.year-filter, .filter-group.agency-filter, .filter-group.circumstance-filter, .filter-group.percentage-change-display { 
                width: 100%; 
                margin-bottom: 8px; 
            } 

            /* MOBILE-IMPROVEMENT: Enhance touch targets for filters */
            .filter-group select, .checkbox-group div {
                padding: 10px;
                min-height: 44px; /* Common practice for touch targets */
            }
            .filter-group select { font-size: 1em; }
            .checkbox-group { 
                max-height: 120px; /* A bit more scroll room */
                padding: 6px;
            }
            .checkbox-group label { font-size: 0.9em; }
            #percentageChangeText { 
                font-size: 1.4em;
                padding: 12px;
            }

            .chart-box h4 { font-size: 1em; }
            /* MOBILE-IMPROVEMENT: Taller chart containers to prevent squishing */
            .chart-canvas-container { min-height: 280px;} 

            .footer { font-size: 0.75em; padding: 8px 10px;}
            
            /* MOBILE-IMPROVEMENT: Make modal more mobile friendly */
            .modal-content {
                width: 95%; /* Use more of the screen width */
                max-height: 90vh; /* Prevent modal from being too tall */
                overflow-y: auto; /* Allow scrolling within the modal if content overflows */
            }
        }

        /* MOBILE-IMPROVEMENT: Add a new breakpoint for very small screens */
        @media (max-width: 480px) {
            .count-banner {
                font-size: 1.1em;
            }
            .ranking-banner {
                font-size: 0.9em;
            }
            .header-logo-main img, .header-logo-secondary img {
                max-height: 28px;
            }
            .chart-box h4 {
                font-size: 0.95em;
            }
            .chart-canvas-container {
                min-height: 250px; /* Slightly smaller for the smallest screens */
            }
            .footer {
                font-size: 0.7em;
            }
            #percentageChangeText {
                font-size: 1.2em;
            }
        }
    </style>
</head>
<body>
    <!-- PERFORMANCE NOTE: The base64 encoded images below significantly increase the initial file size. -->
    <!-- For better mobile performance, it's highly recommended to replace these with optimized .png or .svg files -->
    <!-- loaded via the src attribute (e.g., <img src="/images/logo.png" ...>). -->
    <div class="header">
        <div class="header-logo-main">
            <img id="trackingLogoImg" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA7YAAACeCAYAAAAG7ZZeAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAHH2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgOS4xLWMwMDIgNzkuZjM1NGVmYywgMjAyMy8xMS8wOS0xMjo0MDoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjUgKFdpbmRvd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAyNS0wNS0xNVQxNDowODo0NS0wNTowMCIgeG1wOk1vZGlmeURhdGU9IjIwMjUtMDUtMTVUMTQ6MTE6MTYtMDU6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMjUtMDUtMTVUMTQ6MTE6MTYtMDU6MDAiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOmE1NWMyNjg0LTdiMTctNjI0My1hYzlmLTE3M2I5YTE0YTc3MyIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjdjMDhiY2ZlLWQ1YmItZWU0Yi1hZWY5LTk1YTQ2NWUyZmVkOSIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjM3OGUzZTc3LThiNmMtMDM0ZS1iOTcwLTNlZTJmM2JjMGFjZSI+IDxwaG90b3Nob3A6VGV4dExheWVycz4gPHJkZjpCYWc+IDxyZGY6bGkgcGhvdG9zaG9wOkxheWVyTmFtZT0iVFJBQ0tJTkciIHBob3Rvc2hvcDpMYXllclRleHQ9IlRSQUNLSU5HIi8+IDxyZGY6bGkgcGhvdG9zaG9wOkxheWVyTmFtZT0iSkFDS1NPTuKAmVMgSE9NSUNJREVTIiBwaG90b3Nob3A6TGF5ZXJUZXh0PSJKQUNLU09O4oCZUyBIT01JQ0lERVMiLz4gPC9yZGY6QmFnPiA8L3Bob3Rvc2hvcDpUZXh0TGF5ZXJzPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjM3OGUzZTc3LThiNmMtMDM0ZS1iOTcwLTNlZTJmM2JjMGFjZSIgc3RFdnQ6d2hlbj0iMjAyNS0wNS0xNVQxNDowODo0NS0wNTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDI1LjUgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjb252ZXJ0ZWQiIHN0RXZ0OnBhcmFtZXRlcnM9ImZyb20gYXBwbGljYXRpb24vdm5kLmFkb2JlLnBob3Rvc2hvcCB0byBpbWFnZS9wbmciLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmE1NWMyNjg0LTdiMTctNjI0My1hYzlmLTE3M2I5YTE0YTc3MyIgc3RFdnQ6d2hlbj0iMjAyNS0wNS0xNVQxNDoxMToxNi0wNTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDI1LjUgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRm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" alt="Tracking Jackson's Homicides" onerror="console.error('Error loading Tracking Logo.')">
        </div>
        <div class="header-logo-secondary">
            <img id="wlbtLogoImg" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAGqIAAAmACAYAAABRV2u6AAAACXBIWXMAAC4jAAAuIwF4pT92AAAGGmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgOS4xLWMwMDIgNzkuZjM1NGVmYywgMjAyMy8xMS8wOS0xMjo0MDoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDI1LjUgKDIwMjQwMTIyLm0uMjQ3NSA2NDBjZWE0KSAgKFdpbmRvd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAyNC0wMS0yM1QxMDo1NDozOS0wNjowMCIgeG1wOk1vZGlmeURhdGU9IjIwMjQtMDEtMjNUMTA6NTU6NDEtMDY6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMjQtMDEtMjNUMTA6NTU6NDEtMDY6MDAiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjg0M2M1YTE3LTc1NGUtNTQ0MS1iODMzLTYyZjUyMGVjNGFjOCIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjdhNzFiZDE0LTk0MmEtYzY0MS04YTMwLThmZDI3Yzg0OTc1MSIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjU3NjVlZTExLTBlNmYtODE0NS05ZjBlLTY2NzY0ZTNiODFlMCI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6NTc2NWVlMTEtMGU2Zi04MTQ1LTlmMGUtNjY3NjRlM2I4MWUwIiBzdEV2dDp3aGVuPSIyMDI0LTAxLTIzVDEwOjU0OjM5LTA2OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjUuNSAoMjAyNDAxMjIubS4yNDc1IDY0MGNlYTQpICAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjg0M2M1YTE3LTc1NGUtNTQ0MS1iODMzLTYyZjUyMGVjNGFjOCIgc3RFdnQ6d2hlbj0iMjAyNC0wMS0yM1QxMDo1NTo0MS0wNjowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDI1LjUgKDIwMjQwMTIyLm0uMjQ3NSA2NDBjZWE0KSAgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbi4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pk4e0aMAAaU/SURBVHic7N3Rbhs5EgVQMfD//3LtQ0Yry7GkFtXdrCLPAQLsQxZoZGxRfVnkbZfLJS4AlBARbfQzAAC80lrzngnwgPc6AKAC73UAuXiX7GM94zu/RwAAcM87EwAAQD32OwCOJzcDAAAAAOBd9vH+JW8HAACAsb5GPwAA27XWQtAMAAAAAMBRDPYCAAAAAAAAAOSTeabDmUcAAAAAAADgcsm9rwkAAACr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"/>
        </div>
    </div>

    <div class="count-banner" id="homicideCountBanner">2025 COUNT: 32</div>
    <div class="ranking-banner" id="rankingBanner" style="background-color: rgb(217, 83, 79);">Jackson Homicide Rate Rank: #1 of 50 cities</div>

    <div class="main-content-area">
        <div class="legend-container">
            <div class="filter-columns-wrapper">
                <div class="filter-group year-filter">
                    <label class="group-label" for="yearFilter">Year:</label>
                    <div id="yearFilter" class="checkbox-group"><div><input type="checkbox" id="yearFilter_2025" value="2025"><label for="yearFilter_2025">2025</label></div><div><input type="checkbox" id="yearFilter_2024" value="2024"><label for="yearFilter_2024">2024</label></div><div><input type="checkbox" id="yearFilter_2023" value="2023"><label for="yearFilter_2023">2023</label></div><div><input type="checkbox" id="yearFilter_2022" value="2022"><label for="yearFilter_2022">2022</label></div><div><input type="checkbox" id="yearFilter_2021" value="2021"><label for="yearFilter_2021">2021</label></div><div><input type="checkbox" id="yearFilter_2020" value="2020"><label for="yearFilter_2020">2020</label></div><div><input type="checkbox" id="yearFilter_2019" value="2019"><label for="yearFilter_2019">2019</label></div><div><input type="checkbox" id="yearFilter_2018" value="2018"><label for="yearFilter_2018">2018</label></div><div><input type="checkbox" id="yearFilter_2017" value="2017"><label for="yearFilter_2017">2017</label></div><div><input type="checkbox" id="yearFilter_2016" value="2016"><label for="yearFilter_2016">2016</label></div></div>
                </div>
                <div class="filter-group agency-filter">
                    <label class="group-label" for="agencyFilter">Agency:</label>
                    <div id="agencyFilter" class="checkbox-group"><div><input type="checkbox" id="agencyFilter_Capitol_Police" value="Capitol Police"><label for="agencyFilter_Capitol_Police">Capitol Police</label></div><div><input type="checkbox" id="agencyFilter_JPD" value="JPD"><label for="agencyFilter_JPD">JPD</label></div></div>
                </div>
                <div class="filter-group circumstance-filter">
                    <label class="group-label" for="circumstanceFilter">Circumstance:</label>
                    <select id="circumstanceFilter"><option value="">All Circumstances</option><option value="Blunt force trauma">Blunt force trauma</option><option value="Shooting">Shooting</option><option value="Stabbing">Stabbing</option><option value="Unknown">Unknown</option></select>
                </div>
                 <div class="filter-group percentage-change-display">
                    <label class="group-label">YTD Comparison:</label>
                    <div id="percentageChangeText" style="color: rgb(92, 184, 92);">-46%</div>
                </div>
            </div> 
            </div>
        <div class="map-container">
            <div id="map" class="leaflet-container leaflet-touch leaflet-fade-anim leaflet-grab leaflet-touch-drag leaflet-touch-zoom" tabindex="0" style="position: relative;"></div>
        </div>
    </div>

    <div class="charts-area" id="charts-row-1">
        <div class="chart-box">
            <h4>Homicide Trends Comparison</h4>
            <div class="chart-canvas-container">
                <canvas id="homicideTrendsChart"></canvas>
            </div>
        </div>
        <div class="chart-box">
            <h4>Homicides by Year</h4>
            <div class="chart-canvas-container">
                <canvas id="homicidesByYearChart"></canvas>
            </div>
        </div>
        <div class="chart-box">
            <h4>Victims by Age Group</h4>
            <div class="chart-canvas-container">
                <canvas id="victimsByAgeChart"></canvas>
            </div>
        </div>
    </div>

    <div class="footer">
        <p><a href="#" id="openAboutModal">About the Data</a></p>
        <p>Data Sources: JPD, DPS, Hinds County, JSUPD | Design/Layout: C.J. LeMaster</p>
    </div>

    <!-- NEW: Modal HTML -->
    <div id="aboutDataModal" class="modal-overlay">
        <div class="modal-content">
            <span class="modal-close" id="closeAboutModal">×</span>
            <h2>About the Data</h2>
            <p>Homicides differ from murders because murder implies intent to kill, whereas a homicide is simply the death of one person by another. The two terms are not interchangeable. Because some homicides are considered justifiable, for example, the number of murders in a given year will always be lower than homicides.</p>
            <p>WLBT tracks homicides with the same methodology the Jackson Police Department and many other law enforcement agencies use. Justifiable homicides, including officer-involved deaths, are counted in the numbers. Vehicular homicides, which historically have only been counted by JPD in rare occasions, are not counted unless the agency does so.</p>
            <p>3 On Your Side obtains this information through official releases from JPD and confirmation of killings from departmental sources and the county coroner to reporters. Additionally, when other agencies work as the lead investigating agency on killings, those are also counted in WLBT’s numbers if the killings happen in Jackson.</p>
            <p>For example, in 2024, Capitol Police worked seven homicides. The year before that, Jackson State’s police department handled one. Because we count all killings that happen in the city, our numbers will differ from individual agencies because they only count cases they actually work.</p>
            <p>Some numbers may also fluctuate over time as we learn of additional cases that were not previously reported to us through releases or official confirmation. In October 2023, WLBT uncovered evidence that JPD had failed to disclose cases associated with 24 homicide victims to the public. After that discovery, 3 On Your Side updated its numbers to reflect the department’s count. Following that revelation, WLBT regularly asks JPD for updates on cases to help ensure the department doesn’t let future victims fall through the cracks. </p>
            <p>Finally, you may notice information missing in some of these cases: ages, race, gender or an exact location. That lack of information reflects what the individual law enforcement agency fails to provide to us. Despite those gaps, we do our best to make sure we have as much information as possible to help police solve these cases.</p>
        </div>
    </div>

    <script>
        // --- Configuration ---
        const HOMICIDE_DATA_API_URL = './data/homicide.json'; 
        const CITY_COMPARISON_CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQyiORmxzjhdAokYzM0NhcTjAk1e3hJp81B5OCG03XcPnUaSVrCRiwIXmah2iPSHFaaWbSoKKwFA1Uc/pub?gid=0&single=true&output=csv'; 
        const JACKSON_POPULATION = 143709; 

        const CURRENT_YEAR = 2025; 
        const PREVIOUS_YEAR = CURRENT_YEAR - 1;
        const START_YEAR_DATA = 2016;
        const MAP_CENTER = [32.2988, -90.1848]; 
        const MAP_ZOOM = 12; 

        const JACKSON_CITY_LIMITS_GEOJSON_URL = 'https://dl.dropbox.com/scl/fi/9ct9dki2dsg68iyr7gley/City-Boundaries.geojson?rlkey=vjrtpish5tixdeygp1ja5h7fq&st=fyrqfq4x&dl=1'; 
        const CCID_GEOJSON_URL = 'https://dl.dropbox.com/scl/fi/wva5rzfwwbr8shiz4fkjj/Current-CCID-2024.geojson?rlkey=tvheyfxe94colnxphaan0bsar&st=sqqs09s6&dl=1'; 
        
        const AGENCY_CATEGORIES = {
            CAPITOL_POLICE: 'Capitol Police',
            JPD: 'JPD',
            OTHER: 'Other Agencies' 
        };
        
        const agencyColors = {
            [AGENCY_CATEGORIES.JPD]: 'rgba(0, 123, 255, 0.7)',
            [AGENCY_CATEGORIES.CAPITOL_POLICE]: 'rgba(255, 193, 7, 0.7)',
            [AGENCY_CATEGORIES.OTHER]: 'rgba(40, 167, 69, 0.7)'
        };

        // --- Global State ---
        let allHomicideData = [];
        let cityComparisonData = []; 
        let filteredHomicideDataForMap = []; 
        let map;
        let markersLayer = L.layerGroup();
        let heatLayer; 
        let cityLimitsLayer; 
        let ccidLayer;       
        let overlayLayersControl; 
        let currentMapTileLayer; 

        let homicidesByYearChartInstance;
        let homicideTrendsChartInstance;
        let victimsByRaceChartInstance; 
        let victimsByAgeChartInstance; 

        // --- Initial Load ---
        document.addEventListener('DOMContentLoaded', async () => {
            initMap(); 
            setupModal();

            document.getElementById('homicideCountBanner').innerText = `${CURRENT_YEAR} COUNT: Loading...`;
            document.getElementById('rankingBanner').innerText = 'City Ranking: Loading...';
            document.getElementById('percentageChangeText').innerText = 'Calculating...';

            try {
                const [homicideDataResult, cityDataResult] = await Promise.all([
                    fetchDataAndProcess(HOMICIDE_DATA_API_URL, true), 
                    fetchDataAndProcess(CITY_COMPARISON_CSV_URL, false) 
                ]);

                allHomicideData = homicideDataResult;
                cityComparisonData = cityDataResult;

                logProcessedDataSummary(allHomicideData, "Homicide Data");
                if (cityComparisonData && cityComparisonData.length > 0) {
                    logProcessedDataSummary(cityComparisonData, "City Comparison Data");
                } else if (CITY_COMPARISON_CSV_URL !== 'YOUR_CITY_COMPARISON_CSV_URL_HERE' && CITY_COMPARISON_CSV_URL.trim() !== '') {
                     console.warn("City comparison data is empty or failed to load properly.");
                }

                populateFiltersForMap(); 
                updateCurrentYearHomicideCount();
                updateRankingBanner(); 
                updatePercentageChangeDisplay(); 
                updateDashboard(); 
                if (map) { 
                    map.invalidateSize();
                }
            } catch (error) {
                console.error("Fatal Error initializing dashboard:", error);
                document.getElementById('homicideCountBanner').innerText = 'Error loading data.';
                document.getElementById('rankingBanner').innerText = 'City Ranking: Error';
                document.getElementById('percentageChangeText').innerText = 'Error calculating.';
                 displayErrorInCharts("Failed to load data.");
            }
        });

        // --- Modal Functionality ---
        function setupModal() {
            const modal = document.getElementById("aboutDataModal");
            const openBtn = document.getElementById("openAboutModal");
            const closeBtn = document.getElementById("closeAboutModal");

            openBtn.onclick = function(e) {
                e.preventDefault(); // Prevent link from navigating
                modal.style.display = "flex";
            }

            closeBtn.onclick = function() {
                modal.style.display = "none";
            }

            window.onclick = function(event) {
                if (event.target == modal) {
                    modal.style.display = "none";
                }
            }
             window.addEventListener('keydown', function (event) {
                if (event.key === 'Escape') {
                    modal.style.display = 'none'
                }
            })
        }
        
        function updateMapTiles() { 
            if (!map) return;
            if (currentMapTileLayer) {
                map.removeLayer(currentMapTileLayer);
            }
            currentMapTileLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                maxZoom: 18
            });
            currentMapTileLayer.addTo(map);
        }
        
        function updateBoundaryLayerStyles() { 
            const cityColor = getComputedStyle(document.documentElement).getPropertyValue('--boundary-city-color').trim();
            const ccidColor = getComputedStyle(document.documentElement).getPropertyValue('--boundary-ccid-color').trim();

            const cityStyle = { color: cityColor, weight: 3, opacity: 0.85, fillOpacity: 0.0 }; 
            const ccidStyle = { color: ccidColor, weight: 4, opacity: 0.9, fillOpacity: 0.25 }; 

            if (cityLimitsLayer && map.hasLayer(cityLimitsLayer)) {
                cityLimitsLayer.setStyle(cityStyle);
            }
            if (ccidLayer && map.hasLayer(ccidLayer)) {
                ccidLayer.setStyle(ccidStyle);
            }
        }


        async function fetchDataAndProcess(url, isMainHomicideData = false) { 
            let rawData;
            const dataType = isMainHomicideData ? 'main homicide data' : 'city comparison data';
            const placeholderUrlCity = 'YOUR_CITY_COMPARISON_CSV_URL_HERE';
            let usePlaceholder = false;

            if (!isMainHomicideData && (url === placeholderUrlCity || !url)) { 
                usePlaceholder = true;
            }
            
            if (usePlaceholder) {
                console.warn(`URL for ${dataType} is placeholder or not provided. Using local placeholder data.`);
                rawData = isMainHomicideData ? getPlaceholderData() : getPlaceholderCityData();
            } else {
                const fetchableUrl = url; 
                console.log(`Attempting to fetch ${dataType} from:`, fetchableUrl);
                try {
                    const response = await fetch(fetchableUrl); 
                    console.log(`Fetch response status for ${dataType} (${fetchableUrl}): ${response.status}`); 
                    
                    if (!response.ok) {
                        const errorText = await response.text().catch(() => `Could not read error response text. Status: ${response.status}`);
                        console.error(`Network response was not ok for ${dataType}: ${response.status} ${response.statusText}. URL: ${fetchableUrl}. Response text snippet: ${errorText.substring(0, 200)}`);
                        throw new Error(`Network response was not ok for ${dataType}: ${response.status} ${response.statusText}.`);
                    }

                    if (isMainHomicideData) { 
                        const contentType = response.headers.get("content-type");
                        if (contentType && contentType.toLowerCase().includes("application/json")) { 
                            const responseText = await response.clone().text(); 
                            try {
                                rawData = JSON.parse(responseText); 
                                console.log(`Successfully fetched JSON for ${dataType}.`);
                            } catch (jsonError) {
                                console.error(`Error parsing JSON for ${dataType}:`, jsonError);
                                console.error(`Raw text that failed to parse as JSON (first 500 chars):`, responseText.substring(0,500));
                                throw jsonError; 
                            }
                        } else {
                            const responseText = await response.text();
                            console.error(`Expected JSON response for ${dataType}, but received content type: ${contentType}. Response text:`, responseText.substring(0, 500));
                            throw new Error(`Invalid content type for ${dataType}. Expected JSON, got ${contentType}`);
                        }
                    } else { 
                        const csvText = await response.text(); 
                        rawData = csvToJSON(csvText);
                    }
                } catch (error) {
                    console.error(`Failed to fetch or parse data for ${dataType}. URL: ${fetchableUrl}`, error);
                    console.warn(`Falling back to placeholder data for ${dataType} due to fetch error.`);
                    rawData = isMainHomicideData ? getPlaceholderData() : getPlaceholderCityData();
                }
            }
            
            if (isMainHomicideData) {
                if (!rawData || !rawData.headers || !rawData.entries || rawData.entries.length === 0) {
                    console.warn(`No valid ${dataType} loaded or data structure is incorrect. Raw data received:`, rawData);
                    return [];
                }
                let excludedRecordsLog = [];
                const headers = rawData.headers.map(h => String(h).trim()); 
                const headerMap = {};
                headers.forEach((header, index) => {
                    headerMap[header.toLowerCase()] = index; 
                });
                
                const getHeaderIndex = (possibleNames) => {
                    for (let name of possibleNames) {
                        if (typeof headerMap[name.toLowerCase()] !== 'undefined') return headerMap[name.toLowerCase()];
                    }
                    return -1;
                };

                const victimIdx = getHeaderIndex(['Victim']);
                const ageIdx = getHeaderIndex(['Age']);
                const raceIdx = getHeaderIndex(['Race']);
                const sexIdx = getHeaderIndex(['Sex']);
                const circumstanceIdx = getHeaderIndex(['Circumstance']);
                const dateIdx = getHeaderIndex(['Date']); 
                const yearIdx = getHeaderIndex(['Year']);   
                const monthIdx = getHeaderIndex(['Month']);
                const dayIdx = getHeaderIndex(['Day']);
                const addressIdx = getHeaderIndex(['Address', 'Location']); 
                const agencyIdx = getHeaderIndex(['Investigating Agency', 'Agency']);
                const precinctIdx = getHeaderIndex(['Precinct']);
                const latitudeIdx = getHeaderIndex(['Latitude', 'Lat']);
                const longitudeIdx = getHeaderIndex(['Longitude', 'Lon', 'Long']);
                const locationNotesIdx = getHeaderIndex(['Location Notes', 'Notes']); 

                const mappedData = rawData.entries.map((entry, index) => {
                    let parsedYear = null;
                    let formattedDate = null; 
                    let originalDateStrForDisplay = 'N/A';

                    if (dateIdx !== -1 && entry[dateIdx]) { 
                        const dateStr = String(entry[dateIdx]).trim();
                        originalDateStrForDisplay = dateStr;
                        let dateObj;
                        if (dateStr.includes('-')) { 
                            dateObj = new Date(dateStr + "T00:00:00"); 
                        } else if (dateStr.includes('/')) { 
                             const parts = dateStr.split('/');
                             if (parts.length === 3) { 
                                dateObj = new Date(parts[2], parseInt(parts[0]) - 1, parts[1]);
                             }
                        }
                        
                        if (dateObj && !isNaN(dateObj.getTime())) {
                            parsedYear = dateObj.getFullYear();
                            formattedDate = `${parsedYear}-${(dateObj.getMonth() + 1).toString().padStart(2, '0')}-${dateObj.getDate().toString().padStart(2, '0')}`;
                        }
                    } else if (yearIdx !== -1 && monthIdx !== -1 && dayIdx !== -1) { 
                        const y = parseInt(entry[yearIdx]);
                        const m = parseInt(entry[monthIdx]); 
                        const day = parseInt(entry[dayIdx]);  
                        if (!isNaN(y) && !isNaN(m) && !isNaN(day) && y >= 1900 && y <= CURRENT_YEAR + 10 && m >= 1 && m <= 12 && day >= 1 && day <= 31) {
                            const dateObj = new Date(y, m - 1, day); 
                            if (dateObj && dateObj.getFullYear() === y && dateObj.getMonth() === (m - 1) && dateObj.getDate() === day) {
                                parsedYear = y;
                                formattedDate = `${y}-${m.toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
                                originalDateStrForDisplay = `${m.toString().padStart(2, '0')}/${day.toString().padStart(2, '0')}/${y}`;
                            }
                        }
                    }
                    
                    const latStr = latitudeIdx !== -1 ? entry[latitudeIdx] : null;
                    const lonStr = longitudeIdx !== -1 ? entry[longitudeIdx] : null;
                    const lat = latStr !== null ? parseFloat(latStr) : NaN;
                    const lon = lonStr !== null ? parseFloat(lonStr) : NaN;

                    const isValidLat = !isNaN(lat) && lat >= -90 && lat <= 90;
                    const isValidLon = !isNaN(lon) && lon >= -180 && lon <= 180;
                    const isValidForProcessing = parsedYear !== null && isValidLat && isValidLon;

                    if (!isValidForProcessing && excludedRecordsLog.length < 20) {
                        excludedRecordsLog.push({
                            entryIndex: index,
                            reason: `Parsed Year: ${parsedYear}, Lat Valid: ${isValidLat} (val: ${latStr}), Lon Valid: ${isValidLon} (val: ${lonStr})`,
                            originalEntry: entry
                        });
                    }


                    return {
                        Victim: victimIdx !== -1 ? entry[victimIdx] : 'N/A', 
                        Age: ageIdx !== -1 && entry[ageIdx] ? parseInt(entry[ageIdx]) : null, 
                        Race: raceIdx !== -1 ? entry[raceIdx] : 'N/A', 
                        Sex: sexIdx !== -1 ? entry[sexIdx] : 'N/A',
                        Circumstance: circumstanceIdx !== -1 ? entry[circumstanceIdx] : 'N/A', 
                        Date: formattedDate, 
                        DisplayDate: originalDateStrForDisplay, 
                        Address: addressIdx !== -1 ? entry[addressIdx] : 'N/A', 
                        'Investigating Agency': agencyIdx !== -1 ? entry[agencyIdx] : 'N/A', 
                        Precinct: precinctIdx !== -1 && entry[precinctIdx] ? String(entry[precinctIdx]).trim() : 'N/A',
                        Latitude: lat, 
                        Longitude: lon, 
                        Location: locationNotesIdx !== -1 ? entry[locationNotesIdx] : '', 
                        Year: parsedYear, 
                        _isValidForProcessing: isValidForProcessing
                    };
                });

                const finalData = mappedData.filter(d => d._isValidForProcessing);
                
                if (excludedRecordsLog.length > 0) {
                    console.warn(`Total homicide records initially excluded: ${mappedData.length - finalData.length}. Details for first ${excludedRecordsLog.length} excluded:`, excludedRecordsLog);
                }
                return finalData;
            } else { 
                if (!rawData || rawData.length === 0) {
                    console.warn(`No ${dataType} loaded.`);
                    return [];
                }
                let excludedCitiesLogDetailed = [];
                const processedCityData = rawData.map(d => { 
                    const city = d.City ? String(d.City).trim() : null;
                    const homicidesStr = d.Homicides ? String(d.Homicides).trim() : null;
                    const populationStr = d.Population ? String(d.Population).trim() : null;

                    const homicides = homicidesStr ? parseInt(homicidesStr) : null;
                    const population = populationStr ? parseInt(populationStr) : null;
                    
                    let exclusionReason = "";
                    if (!city) exclusionReason += "Missing City name. ";
                    if (homicides === null || isNaN(homicides) || homicides < 0) exclusionReason += `Invalid Homicides value ('${homicidesStr}'). `;
                    if (population === null || isNaN(population) || population <= 0) exclusionReason += `Invalid Population value ('${populationStr}'). `;

                    const isValidCity = city && !isNaN(homicides) && homicides >= 0 && !isNaN(population) && population > 0;
                    
                    if (!isValidCity) {
                        excludedCitiesLogDetailed.push({ city: city || "Unnamed City", reason: exclusionReason.trim(), originalData: d });
                    }
                    return { City: city, Homicides: homicides, Population: population, _isValid: isValidCity };
                }).filter(d => d._isValid);

                if (excludedCitiesLogDetailed.length > 0) {
                    console.warn(`Total city comparison records excluded: ${excludedCitiesLogDetailed.length}.`);
                }
                return processedCityData;
            }
        }
        
        function logProcessedDataSummary(data, dataType = "Data") {
            if (!data || data.length === 0) {
                console.log(`No ${dataType} to summarize.`);
                return;
            }
            if (dataType === "Homicide Data") {
                const countsByYear = {};
                data.forEach(d => {
                    if (d.Year) { 
                        countsByYear[d.Year] = (countsByYear[d.Year] || 0) + 1;
                    }
                });
                console.log("Counts per year from Homicide Data after processing:", countsByYear);
            } else if (dataType === "City Comparison Data") {
                 console.log(`Total cities for comparison loaded (and valid): ${data.length}`);
            }
        }

        function csvToJSON(csv) { 
            const lines = csv.split(/\r\n|\n/);
            const result = [];
            if (lines.length < 1) return result;
            const headers = lines[0].split(',').map(header => header.trim().replace(/^"|"$/g, '').replace(/(\r\n|\n|\r)/gm,""));
            for (let i = 1; i < lines.length; i++) {
                if (!lines[i].trim()) continue; 
                const obj = {};
                let inQuotes = false;
                let currentValue = '';
                let fieldIndex = 0;
                for (let char of lines[i]) {
                    if (char === '"' && lines[i][lines[i].indexOf(char) + 1] !== '"') { 
                        inQuotes = !inQuotes;
                        continue; 
                    }
                    if (char === ',' && !inQuotes) {
                        if (headers[fieldIndex]) {
                            obj[headers[fieldIndex]] = currentValue.trim();
                        }
                        currentValue = '';
                        fieldIndex++;
                    } else {
                        currentValue += char;
                    }
                }
                if (headers[fieldIndex]) {
                    obj[headers[fieldIndex]] = currentValue.trim();
                }
                result.push(obj);
            }
            return result;
        }

        function getPlaceholderData() { 
            return {
                headers: ["Date", "Location", "Victim", "Agency", "Precinct", "Age", "Sex", "Race", "Circumstance", "Latitude", "Longitude", "Notes"],
                entries: [
                    [`01/15/${CURRENT_YEAR}`, "123 Main St, Jackson, MS", 'John Doe', "JPD", "1", 30, "Male", "Black", "Argument", 32.3010, -90.1850, "Near Capitol Building"],
                    [`02/20/${CURRENT_YEAR}`, "456 Oak Ave, Jackson, MS", 'Jane Smith', "Capitol Police", "2", 25, "Female", "White", "Robbery", 32.2950, -90.1900, "Downtown Area"]
                ]
            };
        }
        function getPlaceholderCityData() { 
            return [
                { City: 'City A', Homicides: 50, Population: 500000 },
                { City: 'City B', Homicides: 120, Population: 1000000 },
            ];
        }


        function initMap() {
            map = L.map('map').setView(MAP_CENTER, MAP_ZOOM);
            updateMapTiles(); 
            markersLayer.addTo(map); 
            heatLayer = L.heatLayer([], { radius: 25 });
            loadBoundaryLayers();
        }

        function updateLayerControl(baseLayers, overlayMaps) {
            if (overlayLayersControl) {
                map.removeControl(overlayLayersControl);
            }
            overlayLayersControl = L.control.layers(baseLayers, overlayMaps).addTo(map);
        }


        function loadBoundaryLayers() {
            const baseLayers = { 
                "Markers": markersLayer,
                "Heatmap": heatLayer
            };
            const overlayMaps = {}; 
            let cityLimitsAttempted = false; 
            let ccidAttempted = false;       
            
            const tryBuildLayerControl = () => {
                if (cityLimitsAttempted && ccidAttempted) {
                    updateBoundaryLayerStyles(); 
                    updateLayerControl(baseLayers, overlayMaps);
                }
            };

            if (JACKSON_CITY_LIMITS_GEOJSON_URL && JACKSON_CITY_LIMITS_GEOJSON_URL !== 'YOUR_JACKSON_CITY_LIMITS_GEOJSON_URL_HERE') {
                fetch(JACKSON_CITY_LIMITS_GEOJSON_URL)
                    .then(response => {
                        if (!response.ok) { throw new Error(`HTTP error! status: ${response.status} for Jackson GeoJSON`); }
                        return response.json();
                    })
                    .then(geojson => {
                        cityLimitsLayer = L.geoJSON(geojson); 
                        overlayMaps["Jackson City Limits"] = cityLimitsLayer;
                        cityLimitsLayer.addTo(map); 
                    })
                    .catch(error => {
                        console.error('Error loading Jackson city limits GeoJSON. URL attempted:', JACKSON_CITY_LIMITS_GEOJSON_URL, error);
                    })
                    .finally(() => {
                        cityLimitsAttempted = true;
                        tryBuildLayerControl();
                    });
            } else {
                console.warn("Jackson City Limits GeoJSON URL is a placeholder or not provided. Boundary not loaded.");
                cityLimitsAttempted = true; 
                tryBuildLayerControl();
            }
            
            if (CCID_GEOJSON_URL && CCID_GEOJSON_URL !== 'YOUR_CCID_GEOJSON_URL_HERE') {
                fetch(CCID_GEOJSON_URL)
                    .then(response => {
                        if (!response.ok) { throw new Error(`HTTP error! status: ${response.status} for CCID GeoJSON`); }
                        return response.json();
                    })
                    .then(geojson => {
                        ccidLayer = L.geoJSON(geojson); 
                        overlayMaps["CCID Boundary"] = ccidLayer;
                        ccidLayer.addTo(map); 
                    })
                    .catch(error => {
                        console.error('Error loading CCID GeoJSON. URL attempted:', CCID_GEOJSON_URL, error);
                    })
                    .finally(() => {
                        ccidAttempted = true;
                        tryBuildLayerControl();
                    });
            } else {
                 console.warn("CCID GeoJSON URL is a placeholder or not provided. Boundary not loaded.");
                 ccidAttempted = true; 
                 tryBuildLayerControl();
            }
        }


        function populateFiltersForMap() { 
            const allYearsFromData = [...new Set(allHomicideData.map(d => d.Year).filter(y => y !== null))].sort((a, b) => b - a);
            const yearsForFilter = allYearsFromData.filter(y => y >= START_YEAR_DATA && y <= CURRENT_YEAR);
            
            const previouslySelectedYears = getSelectedFilterValuesForMap('yearFilter');
            const defaultYearsToSelect = previouslySelectedYears.length > 0 ? previouslySelectedYears : [CURRENT_YEAR];

            let dataForDependentFilters = allHomicideData;
            if (defaultYearsToSelect.length > 0) {
                dataForDependentFilters = allHomicideData.filter(d => defaultYearsToSelect.includes(d.Year));
            }
            
            const agenciesToShow = [...new Set(dataForDependentFilters.map(d => d['Investigating Agency']).filter(a => a))].sort();
            const circumstancesToShow = [...new Set(dataForDependentFilters.map(d => d.Circumstance).filter(c => c))].sort();

            populateCheckboxFilter('yearFilter', yearsForFilter, defaultYearsToSelect, handleYearFilterChange);
            populateCheckboxFilter('agencyFilter', agenciesToShow, agenciesToShow, updateMapAndDependentUI);     
            
            const circumstanceSelect = document.getElementById('circumstanceFilter');
            const previouslySelectedCircumstance = circumstanceSelect.value; 
            circumstanceSelect.innerHTML = '<option value="">All Circumstances</option>';
            circumstancesToShow.forEach(c => {
                 const option = new Option(c, c);
                 if (c === previouslySelectedCircumstance) {
                     option.selected = true;
                 }
                 circumstanceSelect.add(option);
            });
            circumstanceSelect.removeEventListener('change', updateMapAndDependentUI); 
            circumstanceSelect.addEventListener('change', updateMapAndDependentUI);
        }
        
        function handleYearFilterChange() {
            populateFiltersForMap(); 
            updateMapAndDependentUI(); 
        }

        function populateCheckboxFilter(elementId, values, defaultSelected = [], changeCallback) {
            const container = document.getElementById(elementId);
            container.innerHTML = ''; 
            values.forEach(val => {
                const div = document.createElement('div');
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.id = `${elementId}_${val.toString().replace(/\s+/g, '_')}`;
                checkbox.value = val;
                
                const numVal = Number(val);
                const isChecked = (elementId === 'yearFilter') ? defaultSelected.includes(numVal) : defaultSelected.includes(String(val));
                checkbox.checked = isChecked;
                
                checkbox.removeEventListener('change', changeCallback); 
                checkbox.addEventListener('change', changeCallback);

                const label = document.createElement('label');
                label.htmlFor = checkbox.id;
                label.textContent = val;
                div.appendChild(checkbox);
                div.appendChild(label);
                container.appendChild(div);
            });
        }

        function getSelectedFilterValuesForMap(elementId) { 
            const selected = [];
            document.querySelectorAll(`#${elementId} input[type="checkbox"]:checked`).forEach(cb => {
                selected.push(cb.value);
            });
            if (elementId === 'yearFilter') return selected.map(y => parseInt(y));
            return selected;
        }

        function applyFiltersToMapData() { 
            const selectedYears = getSelectedFilterValuesForMap('yearFilter');
            const selectedAgencies = getSelectedFilterValuesForMap('agencyFilter');
            const selectedCircumstance = document.getElementById('circumstanceFilter').value;

            filteredHomicideDataForMap = allHomicideData.filter((d, index) => {
                const dataYear = d.Year; 
                const dataAgency = String(d['Investigating Agency']).trim();
                const dataCircumstance = String(d.Circumstance).trim();

                const yearMatch = selectedYears.length === 0 || selectedYears.includes(dataYear);
                const agencyMatch = selectedAgencies.length === 0 || selectedAgencies.includes(dataAgency);
                const circumstanceMatch = !selectedCircumstance || dataCircumstance === selectedCircumstance;
                
                return yearMatch && agencyMatch && circumstanceMatch; 
            });
        }

        function updateCurrentYearHomicideCount() {
            const currentYearHomicides = allHomicideData.filter(d => d.Year === CURRENT_YEAR).length;
            document.getElementById('homicideCountBanner').innerText = `${CURRENT_YEAR} COUNT: ${currentYearHomicides}`;
        }
        
        function updateRankingBanner() {
            const rankingBanner = document.getElementById('rankingBanner');
            if (!rankingBanner) return;

            const jacksonHomicidesThisYear = allHomicideData.filter(d => d.Year === CURRENT_YEAR).length;
            if (JACKSON_POPULATION <= 0) {
                rankingBanner.innerText = "Jackson population not set for rate calculation.";
                rankingBanner.style.backgroundColor = getComputedStyle(document.documentElement).getPropertyValue('--rank-banner-error-bg').trim();
                return;
            }
            const jacksonRate = (jacksonHomicidesThisYear / JACKSON_POPULATION) * 100000;

            if (!cityComparisonData || cityComparisonData.length === 0) {
                if (CITY_COMPARISON_CSV_URL !== 'YOUR_CITY_COMPARISON_CSV_URL_HERE' && CITY_COMPARISON_CSV_URL.trim() !== '') {
                    rankingBanner.innerText = "City comparison data not available.";
                } else {
                    rankingBanner.innerText = "City Ranking: Data source not configured.";
                }
                rankingBanner.style.backgroundColor = getComputedStyle(document.documentElement).getPropertyValue('--rank-banner-error-bg').trim();
                return;
            }

            const otherCitiesData = cityComparisonData.filter(city => city.City && city.City.toLowerCase() !== 'jackson, ms');

            const citiesWithRates = otherCitiesData.map(city => {
                const rate = (city.Homicides / city.Population) * 100000;
                return { name: city.City, rate: isNaN(rate) ? -1 : rate }; 
            });

            citiesWithRates.push({ name: 'Jackson, MS', rate: isNaN(jacksonRate) ? -1 : jacksonRate });
            citiesWithRates.sort((a, b) => b.rate - a.rate); 

            let jacksonRank = -1;
            for (let i = 0; i < citiesWithRates.length; i++) {
                if (citiesWithRates[i].name === 'Jackson, MS') {
                    jacksonRank = i + 1; 
                    break;
                }
            }
            
            const totalCitiesInRank = citiesWithRates.filter(c => c.rate !== -1).length; 
            let bannerText = `Jackson Homicide Rate Rank: #${jacksonRank} of ${totalCitiesInRank} cities`;
            if (jacksonRank === -1) bannerText = "Jackson rank not determined.";
            
            let bannerColorVar = '--rank-banner-error-bg'; 

            if (jacksonRank === 1) {
                bannerColorVar = '--rank-banner-rank1-bg';
            } else if (jacksonRank >= 2 && jacksonRank <= 5) {
                bannerColorVar = '--rank-banner-rank2to5-bg';
            } else if (jacksonRank > 5) {
                bannerColorVar = '--rank-banner-ranklow-bg';
            }
            
            rankingBanner.innerText = bannerText;
            rankingBanner.style.backgroundColor = getComputedStyle(document.documentElement).getPropertyValue(bannerColorVar).trim();
        }

        function updatePercentageChangeDisplay() {
            const percentageChangeDiv = document.getElementById('percentageChangeText');
            if (!percentageChangeDiv || !allHomicideData || allHomicideData.length === 0) {
                percentageChangeDiv.innerText = 'Data N/A';
                percentageChangeDiv.style.color = getComputedStyle(document.documentElement).getPropertyValue('--percentage-neutral-color');
                return;
            }

            const today = new Date(); 
            const currentMonth = today.getMonth(); 
            const currentDayOfMonth = today.getDate();

            const currentYearCountToDate = allHomicideData.filter(d => {
                if (d.Year !== CURRENT_YEAR || !d.Date) return false;
                const itemDate = new Date(d.Date); 
                return itemDate.getMonth() < currentMonth || (itemDate.getMonth() === currentMonth && itemDate.getDate() <= currentDayOfMonth);
            }).length;

            const previousYearCountToDate = allHomicideData.filter(d => {
                if (d.Year !== PREVIOUS_YEAR || !d.Date) return false;
                const itemDate = new Date(d.Date);
                return itemDate.getMonth() < currentMonth || (itemDate.getMonth() === currentMonth && itemDate.getDate() <= currentDayOfMonth);
            }).length;
            
            let percentageChangeText = "N/A";
            let textColorVar = '--percentage-neutral-color';

            if (previousYearCountToDate > 0) {
                const change = ((currentYearCountToDate - previousYearCountToDate) / previousYearCountToDate) * 100;
                if (change > 0) {
                    percentageChangeText = `+${change.toFixed(0)}%`;
                    textColorVar = '--percentage-increase-color';
                } else if (change < 0) {
                    percentageChangeText = `${change.toFixed(0)}%`;
                    textColorVar = '--percentage-decrease-color';
                } else {
                    percentageChangeText = "0%";
                }
            } else if (currentYearCountToDate > 0) {
                percentageChangeText = `+${currentYearCountToDate} (from 0)`; 
                textColorVar = '--percentage-increase-color';
            } else { 
                 percentageChangeText = "0 (YTD)";
            }
            percentageChangeDiv.innerText = percentageChangeText;
            percentageChangeDiv.style.color = getComputedStyle(document.documentElement).getPropertyValue(textColorVar).trim();
        }


        function updateMapDisplay() { 
            markersLayer.clearLayers();
            if (!map || !heatLayer) return;

             map.invalidateSize(); 
            const visibleMarkers = []; 
            const heatPoints = [];

            filteredHomicideDataForMap.forEach(d => { 
                if (!isNaN(d.Latitude) && !isNaN(d.Longitude)) {
                    const latLng = [d.Latitude, d.Longitude];
                    heatPoints.push(latLng);

                    if (d.Address && d.Address.toLowerCase() !== 'unknown') {
                        const marker = L.circleMarker(latLng, {
                            radius: 6, 
                            fillColor: "#d9534f", 
                            color: "#c82333",     
                            weight: 1, opacity: 1, fillOpacity: 0.8
                        });
                        let displayDate = d.DisplayDate || d.Date || 'N/A';
                        const tooltipContent = `<p><b>Victim:</b> ${d.Victim}</p><p><b>Age:</b> ${d.Age !== null ? d.Age : 'N/A'}</p><p><b>Race:</b> ${d.Race}</p><p><b>Sex:</b> ${d.Sex}</p><p><b>Date:</b> ${displayDate}</p><p><b>Address:</b> ${d.Address}</p><p><b>Circumstance:</b> ${d.Circumstance}</p><p><b>Agency:</b> ${d['Investigating Agency']}</p><p><b>Precinct:</b> ${d.Precinct}</p>${d.Location ? `<p><b>Location Details:</b> ${d.Location}</p>` : ''}`;
                        marker.bindTooltip(tooltipContent, { sticky: true });
                        markersLayer.addLayer(marker);
                        visibleMarkers.push(marker); 
                    }
                }
            });

            heatLayer.setLatLngs(heatPoints);

            if (visibleMarkers.length > 0 && map.hasLayer(markersLayer)) {
                const group = new L.featureGroup(visibleMarkers);
                map.fitBounds(group.getBounds().pad(0.1)); 
            } else if (heatPoints.length > 0 && map.hasLayer(heatLayer)) {
                 map.fitBounds(L.latLngBounds(heatPoints).pad(0.1));
            } else {
                map.setView(MAP_CENTER, MAP_ZOOM);
            }
        }
        
        function getChartOptions() { 
            const textColor = getComputedStyle(document.documentElement).getPropertyValue('--chart-axis-text').trim();
            const gridColor = getComputedStyle(document.documentElement).getPropertyValue('--chart-grid-color').trim();
            const titleColor = getComputedStyle(document.documentElement).getPropertyValue('--chart-title-text').trim();
            const legendColor = getComputedStyle(document.documentElement).getPropertyValue('--chart-legend-text').trim();

            return {
                responsive: true, maintainAspectRatio: false,
                scales: {
                    x: {
                        stacked: true, 
                        title: { display: true, text: 'Year', color: titleColor },
                        ticks: { color: textColor },
                        grid: { color: gridColor }
                    },
                    y: {
                        stacked: true, 
                        beginAtZero: true,
                        title: { display: true, text: 'Number of Homicides', color: titleColor },
                        ticks: { color: textColor },
                        grid: { color: gridColor }
                    }
                },
                plugins: {
                    legend: { position: 'top', labels: { color: legendColor, boxWidth: 20 } },
                    tooltip: { mode: 'index', intersect: false }
                }
            };
        }
        
        function getTrendChartOptions() { 
             const textColor = getComputedStyle(document.documentElement).getPropertyValue('--chart-axis-text').trim();
            const gridColor = getComputedStyle(document.documentElement).getPropertyValue('--chart-grid-color').trim();
            const titleColor = getComputedStyle(document.documentElement).getPropertyValue('--chart-title-text').trim();
            const legendColor = getComputedStyle(document.documentElement).getPropertyValue('--chart-legend-text').trim();

            return {
                 responsive: true, maintainAspectRatio: false,
                    scales: {
                        y: { 
                            beginAtZero: true, 
                            title: {display: true, text: 'Cumulative Homicides', color: titleColor},
                            ticks: { color: textColor },
                            grid: { color: gridColor }
                        },
                        x: {
                            type: 'time',
                            time: { unit: 'month', parser: 'yyyy-MM-dd', tooltipFormat: 'MMM dd', displayFormats: { month: 'MMM' } },
                            title: {display: true, text: 'Month (Displayed on a Common Year for Comparison)', color: titleColor},
                            ticks: { color: textColor },
                            grid: { color: gridColor }
                        }
                    },
                    plugins: { 
                        legend: { 
                            position: 'top', 
                            labels: {
                                usePointStyle: false, 
                                boxWidth: 12, 
                                padding: 10,  
                                generateLabels: function(chart) { 
                                    const datasets = chart.data.datasets;
                                    const currentLegendColor = getComputedStyle(document.documentElement).getPropertyValue('--chart-legend-text').trim(); 
                                    return datasets.map((dataset, i) => {
                                        return {
                                            text: dataset.label,
                                            fillStyle: dataset.borderColor, 
                                            strokeStyle: dataset.borderColor,
                                            lineWidth: 1,
                                            hidden: !chart.isDatasetVisible(i),
                                            index: i,
                                            fontColor: currentLegendColor 
                                        };
                                    });
                                }
                            } 
                        }, 
                        tooltip: { mode: 'index', intersect: false } 
                    }
            };
        }


        function updateHomicidesByYearChart() { 
            const chartOptions = getChartOptions(); 
            chartOptions.scales.x.title.text = 'Year'; 
            chartOptions.scales.y.title.text = 'Number of Homicides';

            const ctx = document.getElementById('homicidesByYearChart').getContext('2d');
            const yearsToDisplay = [];
            for (let y = START_YEAR_DATA; y <= CURRENT_YEAR; y++) {
                yearsToDisplay.push(y);
            }
            const dataByAgencyCategory = {
                [AGENCY_CATEGORIES.JPD]: new Array(yearsToDisplay.length).fill(0),
                [AGENCY_CATEGORIES.CAPITOL_POLICE]: new Array(yearsToDisplay.length).fill(0),
                [AGENCY_CATEGORIES.OTHER]: new Array(yearsToDisplay.length).fill(0),
            };
            allHomicideData.forEach(d => { 
                const yearIndex = yearsToDisplay.indexOf(d.Year); 
                if (yearIndex !== -1) { 
                    const agency = String(d['Investigating Agency']).trim();
                    if (agency === AGENCY_CATEGORIES.JPD) {
                        dataByAgencyCategory[AGENCY_CATEGORIES.JPD][yearIndex]++;
                    } else if (agency === AGENCY_CATEGORIES.CAPITOL_POLICE) {
                        dataByAgencyCategory[AGENCY_CATEGORIES.CAPITOL_POLICE][yearIndex]++;
                    } else { 
                        dataByAgencyCategory[AGENCY_CATEGORIES.OTHER][yearIndex]++;
                    }
                }
            });
            const datasets = Object.keys(AGENCY_CATEGORIES).map(key => {
                const category = AGENCY_CATEGORIES[key];
                return {
                    label: category,
                    data: dataByAgencyCategory[category],
                    backgroundColor: agencyColors[category] || 'rgba(108, 117, 125, 0.7)', 
                    borderColor: (agencyColors[category] || 'rgba(108, 117, 125, 1)').replace('0.7', '1'), 
                    borderWidth: 1
                };
            });
            if (homicidesByYearChartInstance) {
                homicidesByYearChartInstance.destroy();
            }
            homicidesByYearChartInstance = new Chart(ctx, {
                type: 'bar', 
                data: { labels: yearsToDisplay, datasets: datasets },
                options: chartOptions 
            });
        }

        function updateHomicideTrendsChart() {
            const chartOptions = getTrendChartOptions(); 

            const getRunningTotalData = (yearToFilter, dataSet) => {
                const yearData = dataSet.filter(d => d.Year === yearToFilter && d.Date) 
                    .sort((a, b) => { 
                        if (a.Date < b.Date) return -1;
                        if (a.Date > b.Date) return 1;
                        return 0;
                    });
                const chartDataPoints = [];
                const commonAxisYear = 2000; 
                let cumulativeCount = 0;
                let homicideDataIndex = 0;
                let loopEndDate = (yearToFilter === CURRENT_YEAR) ? new Date() : new Date(yearToFilter, 11, 31); 
                
                for (let dLoop = new Date(yearToFilter, 0, 1); dLoop <= loopEndDate; dLoop.setDate(dLoop.getDate() + 1)) {
                    const currentLoopDayFormatted = `${dLoop.getFullYear()}-${(dLoop.getMonth() + 1).toString().padStart(2, '0')}-${dLoop.getDate().toString().padStart(2, '0')}`;
                    while(homicideDataIndex < yearData.length && yearData[homicideDataIndex].Date <= currentLoopDayFormatted) {
                        cumulativeCount++;
                        homicideDataIndex++;
                    }
                    chartDataPoints.push({
                        x: `${commonAxisYear}-${(dLoop.getMonth() + 1).toString().padStart(2, '0')}-${dLoop.getDate().toString().padStart(2, '0')}`,
                        y: cumulativeCount 
                    });
                }
                if (chartDataPoints.length === 0 || chartDataPoints[0].x !== `${commonAxisYear}-01-01`) {
                    chartDataPoints.unshift({ x: `${commonAxisYear}-01-01`, y: 0 });
                } else if (chartDataPoints[0].x === `${commonAxisYear}-01-01` && chartDataPoints[0].y > 0 && !yearData.some(h => h.Date === `${yearToFilter}-01-01`)) {
                    chartDataPoints[0].y = 0;
                }
                return chartDataPoints.filter((p, i, self) => i === self.findIndex(t => t.x === p.x)).sort((a,b) => new Date(a.x) - new Date(b.x));
            };

            const dataForCurrentYear = getRunningTotalData(CURRENT_YEAR, allHomicideData);
            const dataForPreviousYear = getRunningTotalData(PREVIOUS_YEAR, allHomicideData);

            const ctx = document.getElementById('homicideTrendsChart').getContext('2d');
            if (homicideTrendsChartInstance) {
                homicideTrendsChartInstance.destroy();
            }
            homicideTrendsChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: [
                        { label: String(CURRENT_YEAR), data: dataForCurrentYear, borderColor: '#dc3545', tension: 0.1, fill: false, pointRadius: 2, pointHoverRadius: 4 },
                        { label: String(PREVIOUS_YEAR), data: dataForPreviousYear, borderColor: '#007bff', tension: 0.1, fill: false, pointRadius: 2, pointHoverRadius: 4 }
                    ]
                },
                options: chartOptions 
            });
        }

        function updateDemographicCharts() {
            const ageGroups = { '0-17': 0, '18-29': 0, '30-49': 0, '50+': 0, 'Unknown': 0 };
            filteredHomicideDataForMap.forEach(d => {
                const age = d.Age;
                if (age === null || isNaN(age)) {
                    ageGroups['Unknown']++;
                } else if (age <= 17) {
                    ageGroups['0-17']++;
                } else if (age <= 29) {
                    ageGroups['18-29']++;
                } else if (age <= 49) {
                    ageGroups['30-49']++;
                } else {
                    ageGroups['50+']++;
                }
            });

            const ageLabels = Object.keys(ageGroups);
            const ageCounts = Object.values(ageGroups);

            const ageCtx = document.getElementById('victimsByAgeChart').getContext('2d');
            if (victimsByAgeChartInstance) victimsByAgeChartInstance.destroy();
            victimsByAgeChartInstance = new Chart(ageCtx, {
                type: 'bar',
                data: {
                    labels: ageLabels,
                    datasets: [{
                        label: 'Victims by Age Group',
                        data: ageCounts,
                        backgroundColor: '#5bc0de'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { y: { beginAtZero: true } },
                    plugins: { legend: { display: false } }
                }
            });
        }

         function displayErrorInCharts(errorMessage) {
            const chartIds = ['homicidesByYearChart', 'homicideTrendsChart', 'victimsByAgeChart'];
            chartIds.forEach(id => {
                const canvas = document.getElementById(id);
                if (canvas) {
                    const ctx = canvas.getContext('2d');
                    if (window[id + 'Instance']) { window[id + 'Instance'].destroy(); }
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    ctx.font = "16px Arial";
                    ctx.fillStyle = "red";
                    ctx.textAlign = "center";
                    ctx.fillText(errorMessage, canvas.width / 2, canvas.height / 2);
                }
            });
        }
        
        function updateMapAndDependentUI() {
            applyFiltersToMapData(); 
            updateMapDisplay();      
            updatePercentageChangeDisplay(); 
            updateDemographicCharts(); 
        }

        function updateDashboard() {
            applyFiltersToMapData(); 
            updateMapDisplay();
            updateHomicidesByYearChart(); 
            updateHomicideTrendsChart();  
            updateRankingBanner(); 
            updatePercentageChangeDisplay(); 
            updateDemographicCharts(); 
        }
    </script>

</body></html>
